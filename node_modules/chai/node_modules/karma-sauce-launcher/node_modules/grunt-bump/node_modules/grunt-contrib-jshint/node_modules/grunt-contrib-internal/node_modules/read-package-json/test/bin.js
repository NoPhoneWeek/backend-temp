var path = require('path')

var tap = require('tap')

var readJson = require('../')

var createWarningCollector = function () {
  var warn = function (msg) {
    warn.warnings.push(arguments)
  }
  warn.warnings = []
  return warn
}

tap.test('Bin test', function (t) {
  var p = path.resolve(__dirname, 'fixtures/bin.json')
  var warn = createWarningCollector()
  readJson(p, warn, function (er, data) {
    t.equals(warn.warnings.length, 0)
    t.deepEqual(data.bin, {'bin-test': './bin/echo'})
    t.end()
  }